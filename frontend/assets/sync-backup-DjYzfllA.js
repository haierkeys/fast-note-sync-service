import{w as e,r as s,j as t,C as a,H as r,E as o,I as i,J as n,K as l,F as c,G as d}from"./vendor-CePkgVYi.js";import{T as u,a as m,b as x,c as p,d as h,e as g}from"./table-CQW4SH1d.js";import{u as b,a as f,e as j,g as y,t as N,D as v,b as k,c as w,d as S,p as C,B as E,L as P,I as T,m as I}from"./index-BFc3BmsD.js";import{I as U,L as D,E as B,s as L,g as $,h as F,au as z,C as A,_ as V,$ as _,H as R,av as K,z as O,a4 as M,c as q,ac as J,a as G,a0 as H,e as W,aq as Q,aj as X,U as Y,j as Z,aw as ee}from"./vendor-icons-D3bVgkGi.js";import{S as se,a as te,b as ae,c as re,d as oe}from"./select-CLWkWIIA.js";import{C as ie}from"./checkbox-B4wUTeUV.js";import{T as ne}from"./tooltip-hEYc448y.js";import"./vendor-ui-BwPMR9gB.js";import"./vendor-lottie-Cgk9p7OH.js";import"./vendor-animation-Cs3gejBo.js";function le(){const{t:t}=e(),{openConfirmDialog:a}=b(),r=localStorage.getItem("token");return{handleStorageList:s.useCallback(async e=>{try{const s=await fetch(f(j.API_URL+"/api/storage?limit=100"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!s.ok)throw new Error("Network response was not ok");const t=await s.json();t.code<100&&t.code>0?e(t.data||[]):a(t.message+": "+t.details,"error")}catch(s){a(t("api.storage.list.error")+": "+s,"error")}},[r,a,t]),handleStorageDelete:async e=>{try{const s=await fetch(f(j.API_URL+"/api/storage"),{method:"DELETE",body:JSON.stringify({id:e}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!s.ok)throw new Error("Network response was not ok");const o=await s.json();o.code<100&&o.code>0?a(o.message||t("api.storage.delete.success"),"success"):a(o.message+": "+o.details,"error")}catch(s){a(t("api.storage.delete.error")+": "+s,"error")}},handleStorageUpdate:async(e,s)=>{try{const t={...e,isEnabled:e.isEnabled?1:0},o=await fetch(f(j.API_URL+"/api/storage"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!o.ok)throw new Error("Network response was not ok");const i=await o.json();i.code<100&&i.code>0?(a(i.message,"success"),e.id=i.data,s(e)):a(i.message+": "+i.details,"error")}catch(o){a(t("api.storage.save.error")+": "+o,"error")}},handleStorageTypes:async e=>{try{const s=await fetch(f(j.API_URL+"/api/storage/enabled_types"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!s.ok)throw new Error("Network response was not ok");const t=await s.json();t.code<100&&t.code>0?e(t.data||[]):a(t.message+": "+t.details,"error")}catch(s){a(t("api.storage.types.error")+": "+s,"error")}},handleStorageValidate:s.useCallback(async(e,s)=>{try{const a={...e,isEnabled:e.isEnabled?1:0,accessUrlPrefix:e.accessUrlPrefix||"http://placeholder"},o=await fetch(f(j.API_URL+"/api/storage/validate"),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!o.ok)throw new Error(t("api.storage.validate.error"));const i=await o.json();if(i.code>0&&i.code<=200)N.success(t("api.storage.validate.success")),s();else{const e=i.details||i.message||"";N.error(e?`${t("api.storage.validate.error")}: ${e}`:t("api.storage.validate.error"))}}catch(a){N.error(a instanceof Error?a.message:t("api.storage.validate.error"))}},[r,t])}}function ce(){const{t:t}=e(),{openConfirmDialog:a}=b(),r=localStorage.getItem("token"),o=s.useCallback(async e=>{try{const s=await fetch(f(j.API_URL+"/api/backup/configs"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!s.ok)throw new Error("Network response was not ok");const t=await s.json();t.code<100&&t.code>0?e(t.data||[]):a(t.message+": "+t.details,"error")}catch(s){a(t("api.backup.configList.error")+": "+s,"error")}},[r,a,t]),i=s.useCallback(async e=>{try{const s=await fetch(f(j.API_URL+`/api/backup/config?id=${e}`),{method:"DELETE",headers:{Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!s.ok)throw new Error("Network response was not ok");const o=await s.json();o.code<100&&o.code>0?N.success(o.message||t("api.backup.delete.success")):a(o.message+": "+o.details,"error")}catch(s){a(t("api.backup.delete.error")+": "+s,"error")}},[r,a,t]),n=s.useCallback(async(e,s)=>{try{const o=await fetch(f(j.API_URL+"/api/backup/config"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!o.ok)throw new Error("Network response was not ok");const i=await o.json();i.code<100&&i.code>0?(N.success(i.message||t("api.backup.save.success")),s(i.data)):a(i.message+": "+i.details,"error")}catch(o){a(t("api.backup.save.error")+": "+o,"error")}},[r,a,t]),l=s.useCallback(async e=>{try{const s=await fetch(f(j.API_URL+"/api/backup/execute"),{method:"POST",body:JSON.stringify({id:e}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!s.ok)throw new Error("Network response was not ok");const o=await s.json();o.code<100&&o.code>0?N.success(o.message||t("api.backup.execute.success")):a(o.message+": "+o.details,"error")}catch(s){a(t("api.backup.execute.error")+": "+s,"error")}},[r,a,t]),c=s.useCallback(async(e,s,o,i)=>{var n;try{const t=j.API_URL+`/api/backup/historys?page=${e}&pageSize=${s}&configId=${o}`,l=await fetch(f(t),{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,Domain:window.location.origin,Lang:y()}});if(!l.ok)throw new Error("Network response was not ok");const c=await l.json();if(c.code<100&&c.code>0){if(i)if(c.data&&Array.isArray(c.data))i({list:c.data,total:c.total??-1});else if(c.data&&c.data.list){const e=(null==(n=c.data.pager)?void 0:n.totalRows)??c.data.total??0;i({list:c.data.list,total:e})}else i({list:[],total:0})}else a(c.message+": "+c.details,"error")}catch(l){a(t("api.backup.history.error")+": "+l,"error")}},[r,a,t]);return s.useMemo(()=>({handleBackupConfigList:o,handleBackupConfigDelete:i,handleBackupConfigUpdate:n,handleBackupExecute:l,handleBackupHistory:c}),[o,i,n,l,c])}const de=[{pattern:/webdav;.*(401|Unauthorized)/i,key:"error.storage.webdav.unauthorized"},{pattern:/webdav;.*(403|Forbidden)/i,key:"error.storage.webdav.forbidden"},{pattern:/webdav;.*(404|Not Found)/i,key:"error.storage.webdav.notFound"},{pattern:/webdav;.*(405|Method Not Allowed)/i,key:"error.storage.webdav.methodNotAllowed"},{pattern:/webdav;.*no such host/i,key:"error.storage.webdav.unreachable"},{pattern:/webdav;.*connection refused/i,key:"error.storage.webdav.connectionRefused"},{pattern:/webdav;.*(timeout|deadline exceeded)/i,key:"error.storage.webdav.timeout"},{pattern:/webdav;/i,key:"error.storage.webdav.generic"},{pattern:/(aws_s3|minio|cloudflare_r2):.*NoSuchBucket/i,key:"error.storage.s3.noSuchBucket"},{pattern:/(aws_s3|minio|cloudflare_r2):.*AccessDenied/i,key:"error.storage.s3.accessDenied"},{pattern:/(aws_s3|minio|cloudflare_r2):.*no such host/i,key:"error.storage.s3.unreachable"},{pattern:/(aws_s3|minio|cloudflare_r2):.*(timeout|deadline exceeded)/i,key:"error.storage.s3.timeout"},{pattern:/oss:.*NoSuchBucket/i,key:"error.storage.oss.noSuchBucket"},{pattern:/oss:.*AccessDenied/i,key:"error.storage.oss.accessDenied"},{pattern:/oss:.*no such host/i,key:"error.storage.oss.unreachable"},{pattern:/no permission to upload/i,key:"error.storage.local.noPermission"},{pattern:/failed to create the save-fileurl directory/i,key:"error.storage.local.createDirFailed"},{pattern:/permission denied/i,key:"error.storage.local.permissionDenied"},{pattern:/Partial failure:/i,key:"error.backup.partialFailure"},{pattern:/Upload failed:/i,key:"error.backup.uploadFailed"},{pattern:/Failed to open backup file:/i,key:"error.backup.openFileFailed"},{pattern:/Note Vault does not exist/i,key:"error.backup.vaultNotExist"},{pattern:/no such host/i,key:"error.network.unreachable"},{pattern:/connection refused/i,key:"error.network.connectionRefused"},{pattern:/(timeout|deadline exceeded)/i,key:"error.network.timeout"}];function ue(e){if(!e)return null;for(const s of de)if(s.pattern.test(e))return s.key;return null}function me({configId:a,configType:r,open:o,onOpenChange:i}){const{t:n}=e(),{handleBackupHistory:l}=ce(),{handleStorageList:c}=le(),[d,b]=s.useState([]),[f,j]=s.useState([]),[y,P]=s.useState(0),[T,I]=s.useState(1),[z,A]=s.useState(!1),V=s.useCallback(async e=>{A(!0),await l(e,5,a,e=>{b(e.list),P(e.total)}),A(!1)},[a,l]);s.useEffect(()=>{o&&(c(j),I(1),V(1))},[o,V,c]);const _=e=>{const s=f.find(s=>Number(s.id)===e);return s?s.type:"-"},R=e=>{if(!e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["B","KB","MB","GB","TB"][s]},K=Math.ceil(y/5);return t.jsx(v,{open:o,onOpenChange:i,children:t.jsxs(k,{className:"max-w-5xl max-h-[85vh] flex flex-col p-6",children:[t.jsx(w,{className:"mb-4",children:t.jsxs(S,{className:"flex items-center gap-2",children:[t.jsx(U,{className:"h-5 w-5 text-primary"}),n("ui.backup.history.title")]})}),t.jsx("div",{className:"flex-1 overflow-auto border rounded-xl bg-card/50",children:t.jsxs(u,{children:[t.jsx(m,{className:"bg-muted/50 sticky top-0 z-10",children:t.jsxs(x,{children:[t.jsx(p,{className:"w-[180px]",children:n("ui.backup.history.startTime")}),t.jsx(p,{children:n("ui.backup.history.storage")}),t.jsx(p,{children:n("ui.backup.history.status")}),t.jsx(p,{children:n("sync"===r?"ui.backup.history.syncStats":"ui.backup.history.backupStats")}),t.jsx(p,{children:n("ui.backup.history.backupFile")}),t.jsx(p,{className:"max-w-[200px]",children:n("ui.backup.history.message")})]})}),t.jsx(h,{children:z?t.jsx(x,{children:t.jsx(g,{colSpan:6,className:"h-48",children:t.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground gap-2",children:[t.jsx(D,{className:"h-8 w-8 animate-spin opacity-50"}),t.jsx("span",{className:"text-xs",children:n("ui.common.loading")})]})})}):d.length>0?d.map(e=>t.jsxs(x,{className:"text-xs hover:bg-muted/30 transition-colors",children:[t.jsx(g,{className:"font-mono text-muted-foreground",children:e.startTime}),t.jsx(g,{children:"-"!==_(e.storageId)?`#${e.storageId} ${n(`ui.storage.storageType.${_(e.storageId)}`)}`:"-"}),t.jsx(g,{children:t.jsx("span",{className:C("px-2 py-0.5 rounded-full font-medium inline-block",2===e.status?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":3===e.status?"bg-destructive/10 text-destructive dark:bg-destructive/20":5===e.status?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-muted text-muted-foreground"),children:n(`ui.backup.status.${e.status}`)})}),t.jsx(g,{children:t.jsxs("div",{className:"flex flex-col gap-0.5",children:[t.jsx("span",{children:R(e.fileSize)}),t.jsxs("span",{className:"text-muted-foreground opacity-70 text-[10px]",children:[e.fileCount||0," ",n("ui.backup.fileCountUnit")]})]})}),t.jsx(g,{className:"max-w-[150px] truncate",children:"sync"!==e.type&&e.filePath?(()=>{const s=((e,s)=>{const t=f.find(s=>Number(s.id)===e);if(!t||!t.accessUrlPrefix)return null;let a=t.accessUrlPrefix.endsWith("/")?t.accessUrlPrefix.slice(0,-1):t.accessUrlPrefix;if(t.customPath){let e=t.customPath.startsWith("/")?t.customPath.substring(1):t.customPath;e=e.endsWith("/")?e.slice(0,-1):e,e&&(a+="/"+e)}return a+="/"+(s.startsWith("/")?s.substring(1):s),a})(e.storageId,e.filePath),a=e.filePath.split("/").pop()||e.filePath;return s?t.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-blue-500 hover:underline flex items-center gap-1 transition-colors",title:e.filePath,children:[t.jsx("span",{className:"truncate",children:a}),t.jsx(B,{className:"h-3 w-3 shrink-0 opacity-50"})]}):t.jsx("span",{title:e.filePath,className:"truncate inline-block max-w-full",children:a})})():t.jsx("span",{className:"text-muted-foreground",children:"-"})}),t.jsx(g,{className:"max-w-[250px]",children:(()=>{if(!e.message)return t.jsx("span",{className:"opacity-70",children:"-"});const s=3===e.status?ue(e.message):null;return s?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"truncate text-destructive/90",title:e.message,children:n(s)}),t.jsx(E,{variant:"ghost",size:"icon",className:"h-5 w-5 shrink-0 text-muted-foreground hover:text-primary",onClick:()=>{navigator.clipboard.writeText(e.message).then(()=>N.success(n("ui.common.copied")),()=>N.error(n("ui.common.error")))},title:n("ui.backup.history.copyError"),children:t.jsx(L,{className:"h-3 w-3"})})]}):3===e.status?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:"truncate opacity-70",title:e.message,children:e.message}),t.jsx(E,{variant:"ghost",size:"icon",className:"h-5 w-5 shrink-0 text-muted-foreground hover:text-primary",onClick:()=>{navigator.clipboard.writeText(e.message).then(()=>N.success(n("ui.common.copied")),()=>N.error(n("ui.common.error")))},title:n("ui.backup.history.copyError"),children:t.jsx(L,{className:"h-3 w-3"})})]}):t.jsx("span",{className:"truncate opacity-70",title:e.message,children:e.message})})()})]},e.id)):t.jsx(x,{children:t.jsx(g,{colSpan:6,className:"h-48 text-center text-muted-foreground",children:n("ui.backup.history.noData")})})})]})}),(K>1||-1===y&&(5===d.length||T>1))&&t.jsxs("div",{className:"flex items-center justify-between mt-4 px-1",children:[t.jsx("div",{className:"text-xs text-muted-foreground",children:-1!==y&&`${n("ui.common.total")} ${y} ${n("ui.common.items")}`}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(E,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",onClick:()=>{const e=T-1;I(e),V(e)},disabled:T<=1||z,children:t.jsx($,{className:"h-4 w-4"})}),t.jsx("span",{className:"text-xs font-medium px-2",children:-1!==y?`${T} / ${K}`:`${n("ui.common.page")} ${T}`}),t.jsx(E,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",onClick:()=>{const e=T+1;I(e),V(e)},disabled:(-1!==y?T>=K:d.length<5)||z,children:t.jsx(F,{className:"h-4 w-4"})})]})]})]})})}const xe=["oss","s3","r2","minio","localfs","webdav"];function pe({config:u,types:m,onSubmit:x,onCancel:p}){const{t:h}=e(),[g,b]=s.useState(null==u?void 0:u.type),{handleStorageUpdate:f,handleStorageValidate:j}=le(),[y,N]=s.useState(!1),v=s.useMemo(()=>{return a({type:i(xe,{required_error:(e=h)("ui.validation.storage.typeRequired")}),endpoint:o().optional(),region:o().optional(),accountId:o().optional(),bucketName:o().optional(),accessKeyId:o().optional(),accessKeySecret:o().optional(),user:o().optional(),password:o().optional(),customPath:o().optional(),accessUrlPrefix:o().min(1,e("ui.validation.storage.accessUrlPrefixRequired")),isEnabled:r([n(),l()]).transform(e=>Boolean(e)).default(!1).optional()});var e},[h]),{register:k,handleSubmit:w,formState:{errors:S,isSubmitting:C},setValue:I,getValues:U}=c({resolver:d(v),defaultValues:u||{isEnabled:!0}});s.useEffect(()=>{const e=e=>{"Escape"===e.key&&p&&(e.preventDefault(),p())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[p]);return t.jsxs("form",{onSubmit:w(e=>{u&&(e.id=u.id),f(e,()=>{x()})}),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-3",children:[t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"type",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.type")}),t.jsxs(se,{name:"type",onValueChange:e=>{I("type",e),b(e)},defaultValue:null==u?void 0:u.type,children:[t.jsx(te,{id:"type",className:"bg-background border-input focus:ring-primary/20",children:t.jsx(ae,{placeholder:h("ui.storage.selectType")})}),t.jsx(re,{children:m.map((e,s)=>t.jsx(oe,{value:e,children:h(`ui.storage.storageType.${e}`)},s))})]}),S.type&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.type.message})]}),"oss"===g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"endpoint",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.endpoint")}),t.jsx(T,{id:"endpoint",autoComplete:"off",placeholder:h("ui.storage.placeholder.endpoint.oss"),className:"bg-background border-input",...k("endpoint")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.endpoint.oss")}),S.endpoint&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.endpoint.message})]}),("s3"===g||"minio"===g)&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"region",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.region")}),t.jsx(T,{id:"region",autoComplete:"off",placeholder:h("ui.storage.placeholder.region"),className:"bg-background border-input",...k("region")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.region")}),S.region&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.region.message})]}),"r2"===g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"accountId",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.accountId")}),t.jsx(T,{id:"accountId",autoComplete:"off",placeholder:h("ui.storage.placeholder.accountId"),className:"bg-background border-input",...k("accountId")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.accountId")}),S.accountId&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.accountId.message})]}),"webdav"===g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"endpoint",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.webdavUrl")}),t.jsx(T,{id:"endpoint",autoComplete:"off",placeholder:h("ui.storage.placeholder.webdavUrl"),className:"bg-background border-input",...k("endpoint")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.webdavUrl")}),S.endpoint&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.endpoint.message})]}),"webdav"===g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"user",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.webdavUser")}),t.jsx(T,{id:"user",autoComplete:"off",placeholder:h("ui.storage.placeholder.webdavUser"),className:"bg-background border-input",...k("user")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.webdavUser")}),S.user&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.user.message})]}),"webdav"===g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"password",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.webdavPassword")}),t.jsx(T,{id:"password",type:"text",placeholder:h("ui.storage.placeholder.webdavPassword"),className:"bg-background border-input no-password-prompt",...k("password")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.webdavPassword")}),S.password&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.password.message})]}),"minio"===g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"endpoint",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.endpoint")}),t.jsx(T,{id:"endpoint",autoComplete:"off",placeholder:h("ui.storage.placeholder.endpoint.minio"),className:"bg-background border-input",...k("endpoint")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.endpoint.minio")}),S.endpoint&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.endpoint.message})]}),"localfs"!==g&&"webdav"!==g&&void 0!==g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"bucketName",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.bucketName")}),t.jsx(T,{id:"bucketName",autoComplete:"off",placeholder:h("ui.storage.placeholder.bucketName"),className:"bg-background border-input",...k("bucketName")}),S.bucketName&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.bucketName.message})]}),"localfs"!==g&&"webdav"!==g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"accessKeyId",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.accessKeyId")}),t.jsx(T,{id:"accessKeyId",autoComplete:"off",placeholder:h("ui.storage.placeholder.accessKeyId"),className:"bg-background border-input",...k("accessKeyId")}),S.accessKeyId&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.accessKeyId.message})]}),"localfs"!==g&&"webdav"!==g&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"accessKeySecret",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.accessKeySecret")}),t.jsx(T,{id:"accessKeySecret",type:"text",placeholder:h("ui.storage.placeholder.accessKeySecret"),className:"bg-background border-input no-password-prompt",...k("accessKeySecret")}),S.accessKeySecret&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.accessKeySecret.message})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"customPath",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.customPath")}),t.jsx(T,{id:"customPath",autoComplete:"off",placeholder:h("ui.storage.placeholder.customPath"),className:"bg-background border-input",...k("customPath")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.customPath")}),S.customPath&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.customPath.message})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{htmlFor:"accessUrlPrefix",className:"text-xs font-semibold text-muted-foreground ml-1",children:h("ui.storage.accessUrlPrefix")}),t.jsx(T,{id:"accessUrlPrefix",autoComplete:"off",placeholder:h("ui.storage.placeholder.accessUrlPrefix"),className:"bg-background border-input",...k("accessUrlPrefix")}),t.jsx("p",{className:"text-[11px] text-muted-foreground ml-1",children:h("ui.storage.help.accessUrlPrefix")}),S.accessUrlPrefix&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:S.accessUrlPrefix.message})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-border",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ie,{id:"isEnabled",name:"isEnabled",defaultChecked:!u||!!u.isEnabled,onCheckedChange:e=>I("isEnabled",Boolean(e)),className:"border-input data-[state=checked]:bg-primary data-[state=checked]:border-primary"}),t.jsx(P,{htmlFor:"isEnabled",className:"text-sm font-medium text-foreground",children:h("ui.common.isEnabled")})]}),t.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[p&&t.jsx(E,{type:"button",variant:"ghost",onClick:p,disabled:C||y,children:h("ui.common.cancel")}),t.jsxs(E,{type:"button",variant:"outline",size:"sm",className:"px-6 rounded-lg",disabled:C||y||!g,onClick:async()=>{const e=U();if(e.type){N(!0);try{await j(e,()=>{})}finally{N(!1)}}},children:[t.jsx(z,{className:"h-4 w-4 mr-1.5"}),h(y?"ui.storage.validate.loading":"ui.storage.validate.title")]}),t.jsx(E,{type:"submit",size:"sm",className:"px-8 rounded-lg shadow-sm",disabled:C||y,children:h(u?"ui.common.save":"ui.common.add")})]})]})]})}function he({config:r,storages:u,onSubmit:m,onCancel:x}){const{t:p}=e(),{handleBackupConfigUpdate:h}=ce(),{handleVaultList:g}=I(),[b,f]=s.useState([]),j=u.filter(e=>e.isEnabled),y=(null==r?void 0:r.storageIds)?JSON.parse(r.storageIds).filter(e=>j.some(s=>Number(s.id)===e)):[],[N,v]=s.useState(y);s.useEffect(()=>{g(f)},[g]),s.useEffect(()=>{const e=e=>{"Escape"===e.key&&x&&(e.preventDefault(),x())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[x]);const k=(w=p,a({vault:o().min(1,w("ui.backup.validation.vaultRequired")),type:i(["full","incremental","sync"],{required_error:w("ui.backup.validation.typeRequired")}),cronStrategy:i(["daily","weekly","monthly","custom"],{required_error:w("ui.backup.validation.strategyRequired")}),cronExpression:o().optional(),storageIds:o().refine(e=>{try{const s=JSON.parse(e);return Array.isArray(s)&&s.length>0}catch{return!1}},w("ui.backup.validation.storageRequired")),isEnabled:n().default(!0),includeVaultName:n().default(!1),retentionDays:l().int().min(-1,w("ui.backup.validation.retentionDaysMin")).optional()}).refine(e=>!("custom"===e.cronStrategy&&!e.cronExpression),{message:w("ui.backup.validation.cronExpressionRequired"),path:["cronExpression"]}));var w;const{register:S,handleSubmit:U,formState:{errors:D},setValue:B,watch:L}=c({resolver:d(k),defaultValues:{vault:(null==r?void 0:r.vault)||"",type:null==r?void 0:r.type,cronStrategy:(null==r?void 0:r.cronStrategy)||"daily",cronExpression:(null==r?void 0:r.cronExpression)||"0 0 * * *",storageIds:JSON.stringify(y),isEnabled:(null==r?void 0:r.isEnabled)??!0,includeVaultName:(null==r?void 0:r.includeVaultName)??!1,retentionDays:(null==r?void 0:r.retentionDays)??30}}),$=L("cronStrategy");return t.jsxs("form",{onSubmit:U(e=>{h({...e,id:null==r?void 0:r.id},()=>{m()})}),className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-3",children:[t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{className:"text-xs font-semibold text-muted-foreground ml-1",children:p("ui.backup.vault")}),t.jsxs(se,{onValueChange:e=>B("vault",e),defaultValue:null==r?void 0:r.vault,children:[t.jsx(te,{className:"bg-background border-input",children:t.jsx(ae,{placeholder:p("ui.backup.selectVault")})}),t.jsx(re,{children:b.map(e=>t.jsx(oe,{value:e.vault,children:e.vault},e.id))})]}),D.vault&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:D.vault.message})]}),t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{className:"text-xs font-semibold text-muted-foreground ml-1",children:p("ui.backup.type")}),t.jsxs(se,{onValueChange:e=>B("type",e),defaultValue:null==r?void 0:r.type,children:[t.jsx(te,{className:"bg-background border-input",children:t.jsx(ae,{placeholder:p("ui.backup.selectType")})}),t.jsxs(re,{children:[t.jsx(oe,{value:"full",children:p("ui.backup.backupType.full")}),t.jsx(oe,{value:"incremental",children:p("ui.backup.backupType.incremental")}),t.jsx(oe,{value:"sync",children:p("ui.backup.backupType.sync")})]})]}),D.type&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:D.type.message})]}),"sync"===L("type")&&t.jsx("div",{className:"space-y-1.5 md:col-span-2",children:t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ie,{id:"includeVaultName",checked:L("includeVaultName"),onCheckedChange:e=>B("includeVaultName",Boolean(e))}),t.jsx(P,{htmlFor:"includeVaultName",className:"text-sm font-medium text-foreground",children:p("ui.backup.includeVaultName.label")}),t.jsx(ne,{content:t.jsx("div",{className:"whitespace-pre-line text-left",children:p("ui.backup.includeVaultName.tooltip")}),side:"right",children:t.jsx(A,{className:"h-4 w-4 text-muted-foreground cursor-help"})})]})}),("full"===L("type")||"incremental"===L("type"))&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{className:"text-xs font-semibold text-muted-foreground ml-1",children:p("ui.backup.cronStrategy")}),t.jsxs(se,{onValueChange:e=>B("cronStrategy",e),defaultValue:(null==r?void 0:r.cronStrategy)||"daily",children:[t.jsx(te,{className:"bg-background border-input",children:t.jsx(ae,{})}),t.jsxs(re,{children:[t.jsx(oe,{value:"daily",children:p("ui.backup.strategy.daily")}),t.jsx(oe,{value:"weekly",children:p("ui.backup.strategy.weekly")}),t.jsx(oe,{value:"monthly",children:p("ui.backup.strategy.monthly")}),t.jsx(oe,{value:"custom",children:p("ui.backup.strategy.custom")})]})]}),D.cronStrategy&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:D.cronStrategy.message})]}),t.jsxs("div",{className:C("space-y-1.5","custom"!==$&&"opacity-50 pointer-events-none"),children:[t.jsx(P,{className:"text-xs font-semibold text-muted-foreground ml-1",children:p("ui.backup.cronExpression")}),t.jsx(T,{...S("cronExpression"),placeholder:"0 0 * * *",className:"bg-background border-input",disabled:"custom"!==$}),D.cronExpression&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:D.cronExpression.message})]})]}),("full"===L("type")||"incremental"===L("type")||"sync"===L("type"))&&t.jsxs("div",{className:"space-y-1.5",children:[t.jsx(P,{className:"text-xs font-semibold text-muted-foreground ml-1",children:"sync"===L("type")?p("ui.backup.retentionDays.sync"):"full"===L("type")||"incremental"===L("type")?p("ui.backup.retentionDays.backup"):p("ui.backup.retentionDays")}),t.jsx(T,{type:"number",...S("retentionDays",{valueAsNumber:!0}),placeholder:"30",className:"bg-background border-input"}),D.retentionDays&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:D.retentionDays.message})]}),t.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[t.jsx(P,{className:"text-xs font-semibold text-muted-foreground ml-1",children:p("ui.backup.storages")}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 border border-input rounded-md p-3 bg-background/50",children:0===j.length?t.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center p-4 text-center text-muted-foreground bg-muted/30 rounded-md border border-dashed",children:[t.jsx("span",{className:"text-sm mb-2",children:p("ui.backup.noAvailableStorage")}),t.jsx("p",{className:"text-xs opacity-70 mb-2",children:p("ui.backup.addStorageTip")})]}):j.map(e=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ie,{id:`storage-${e.id}`,checked:N.includes(Number(e.id)),onCheckedChange:()=>(e=>{const s=N.includes(e)?N.filter(s=>s!==e):[...N,e];v(s),B("storageIds",JSON.stringify(s))})(Number(e.id))}),t.jsxs(P,{htmlFor:`storage-${e.id}`,className:"text-sm font-normal cursor-pointer truncate",children:[p(`ui.storage.storageType.${e.type}`)," (",e.id,")"]})]},e.id))}),D.storageIds&&t.jsx("p",{className:"text-[11px] text-destructive mt-1 ml-1",children:D.storageIds.message})]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-border",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ie,{id:"isEnabledBackup",checked:L("isEnabled"),onCheckedChange:e=>B("isEnabled",Boolean(e))}),t.jsx(P,{htmlFor:"isEnabledBackup",className:"text-sm font-medium text-foreground",children:p("ui.common.isEnabled")})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[x&&t.jsx(E,{type:"button",variant:"ghost",onClick:x,children:p("ui.common.cancel")}),t.jsx(E,{type:"submit",size:"sm",className:"px-8 rounded-lg shadow-sm",children:p(r?"ui.common.save":"ui.common.add")})]})]})]})}function ge(){const{t:a}=e(),{openConfirmDialog:r}=b(),[o,i]=s.useState([]),[n,l]=s.useState(null),[c,d]=s.useState(!1),[u,m]=s.useState(xe),[x,p]=s.useState([]),[h,g]=s.useState(null),[f,j]=s.useState(!1),[y,N]=s.useState(null),[v,k]=s.useState(void 0),[w,S]=s.useState(!1),{handleStorageList:P,handleStorageDelete:T,handleStorageTypes:I}=le(),{handleBackupConfigList:U,handleBackupConfigDelete:B,handleBackupExecute:L}=ce();s.useEffect(()=>{$()},[]);const $=async()=>{I(m),P(i),U(p)};return t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pb-24 md:pb-4 items-start",children:[t.jsx("div",{className:"rounded-xl border border-border bg-card p-6 custom-shadow",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold",children:a("ui.backup.management")}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(E,{variant:"ghost",size:"icon",onClick:$,className:"rounded-xl shrink-0 h-10 w-10 text-muted-foreground hover:text-primary",title:a("ui.common.refresh"),children:t.jsx(V,{className:"h-4 w-4"})}),t.jsxs(E,{onClick:()=>j(!0),className:"rounded-xl shrink-0",children:[t.jsx(_,{className:"h-4 w-4 mr-2"}),a("ui.common.add")]})]})]}),f&&t.jsxs("div",{className:"p-4 md:p-5 border border-primary/10 rounded-xl bg-primary/5 custom-shadow-sm mb-4 animate-in fade-in slide-in-from-top-4 duration-300",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx("div",{className:"h-6 w-1 bg-primary rounded-full mr-3"}),t.jsx("h3",{className:"text-base font-bold text-foreground",children:a("ui.backup.add")})]}),t.jsx(he,{storages:o,onSubmit:async()=>{await $(),j(!1)},onCancel:()=>j(!1)})]}),null!==h&&t.jsxs("div",{className:"p-4 md:p-5 border border-primary/10 rounded-xl bg-primary/5 custom-shadow-sm mb-4 animate-in fade-in slide-in-from-top-4 duration-300",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx("div",{className:"h-6 w-1 bg-primary rounded-full mr-3"}),t.jsx("h3",{className:"text-base font-bold text-foreground",children:a("ui.backup.edit")})]}),t.jsx(he,{storages:o,config:x.find(e=>e.id===h),onSubmit:async()=>{await $(),g(null)},onCancel:()=>g(null)})]}),t.jsx("div",{className:"flex flex-col gap-2",children:x&&x.length>0?x.map(e=>t.jsxs("div",{className:C("group relative flex flex-col p-3 transition-all duration-200 hover:shadow-sm border rounded-lg bg-background hover:bg-accent/50",e.isEnabled?"border-l-4 border-l-blue-600 dark:border-l-blue-500 shadow-sm":"border-l-4 border-l-muted border-y-border border-r-border"),children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(z,{className:C("h-4 w-4",e.isEnabled?"text-blue-500":"text-muted-foreground")}),t.jsxs("span",{className:"text-sm tabular-nums text-muted-foreground font-mono font-bold",children:["#",e.id]}),t.jsx("span",{className:"font-bold text-sm",children:e.vault}),t.jsx("span",{className:"text-[10px] px-1.5 py-0.5 bg-accent rounded text-accent-foreground uppercase",children:a(`ui.backup.backupType.${e.type}`)})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(E,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-primary rounded-md",onClick:()=>{N(e.id),k(e.type),S(!0)},title:a("ui.backup.history.title"),children:t.jsx(R,{className:"h-3 w-3"})}),t.jsx(E,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-blue-600 rounded-md",onClick:()=>(async e=>{await L(e),setTimeout(()=>U(p),1e3)})(e.id),title:a("ui.backup.executeNow"),children:t.jsx(K,{className:"h-3 w-3"})}),t.jsx(E,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-primary rounded-md",onClick:()=>{return s=e.id,g(null),void setTimeout(()=>g(s),0);var s},children:t.jsx(O,{className:"h-3 w-3"})}),t.jsx(E,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-destructive rounded-md",onClick:()=>(async e=>{r(a("ui.backup.confirmDelete"),"confirm",async()=>{await B(e),await $()})})(e.id),children:t.jsx(M,{className:"h-3 w-3"})})]})]}),t.jsxs("div",{className:"flex flex-col gap-y-1 text-[11px] text-muted-foreground",children:[t.jsxs("div",{className:"mt-1 pt-1 border-t border-border/50 opacity-70 flex items-center justify-between",children:[t.jsx("div",{className:"flex items-center gap-1.5",children:e.lastRunTime?t.jsxs("span",{children:[a("ui.backup.lastRunTime"),": ",e.lastRunTime]}):t.jsx("span",{children:a("ui.backup.noBackup")})}),t.jsxs("div",{className:"flex items-center gap-1.5 min-w-[3.5rem] justify-end",children:[1===e.lastStatus?t.jsx(D,{className:"h-3 w-3 animate-spin text-blue-500"}):2===e.lastStatus?t.jsx(q,{className:"h-3 w-3 text-green-500"}):3===e.lastStatus?t.jsx(J,{className:"h-3 w-3 text-destructive"}):4===e.lastStatus?t.jsx(G,{className:"h-3 w-3 text-muted-foreground"}):5===e.lastStatus?t.jsx(q,{className:"h-3 w-3 text-blue-400"}):t.jsx(H,{className:"h-3 w-3 opacity-50"}),t.jsx("span",{className:C("font-medium",2===e.lastStatus?"text-green-500":3===e.lastStatus?"text-destructive":5===e.lastStatus?"text-blue-400 dark:text-blue-300":""),children:void 0!==e.lastStatus?a(`ui.backup.status.${e.lastStatus}`):a("ui.common.unknown")})]})]}),3===e.lastStatus&&e.lastMessage&&(()=>{const s=ue(e.lastMessage);return t.jsx("div",{className:"text-[10px] text-destructive/80 truncate",title:e.lastMessage,children:s?a(s):e.lastMessage})})()]})]},e.id)):t.jsxs("div",{className:"py-12 flex flex-col items-center justify-center text-muted-foreground border-2 border-dashed border-border/50 rounded-xl bg-muted/20 mt-4",children:[t.jsx(W,{className:"h-12 w-12 mb-3 opacity-20"}),t.jsx("p",{className:"text-sm opacity-70 font-medium",children:a("ui.backup.noBackup")})]})})]})}),t.jsx("div",{className:"rounded-xl border border-border bg-card p-6 custom-shadow",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold",children:a("ui.storage.management")}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(E,{variant:"ghost",size:"icon",onClick:$,className:"rounded-xl shrink-0 h-10 w-10 text-muted-foreground hover:text-primary",title:a("ui.common.refresh"),children:t.jsx(V,{className:"h-4 w-4"})}),t.jsxs(E,{onClick:()=>d(!0),className:"rounded-xl shrink-0",children:[t.jsx(_,{className:"h-4 w-4 mr-2"}),a("ui.common.add")]})]})]}),c&&t.jsxs("div",{className:"p-4 md:p-5 border border-primary/10 rounded-xl bg-primary/5 custom-shadow-sm mb-4 animate-in fade-in slide-in-from-top-4 duration-300",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx("div",{className:"h-6 w-1 bg-primary rounded-full mr-3"}),t.jsx("h3",{className:"text-base font-bold text-foreground",children:a("ui.storage.add")})]}),t.jsx(pe,{types:u,onSubmit:async()=>{await $(),d(!1)},onCancel:()=>d(!1)})]}),n&&t.jsxs("div",{className:"p-4 md:p-5 border border-primary/10 rounded-xl bg-primary/5 custom-shadow-sm mb-4 animate-in fade-in slide-in-from-top-4 duration-300",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx("div",{className:"h-6 w-1 bg-primary rounded-full mr-3"}),t.jsx("h3",{className:"text-base font-bold text-foreground",children:a("ui.storage.edit")})]}),t.jsx(pe,{types:u,config:o.find(e=>e.id===n),onSubmit:async()=>{await $(),l(null)},onCancel:()=>l(null)})]}),t.jsx("div",{className:"flex flex-col gap-2",children:o&&o.length>0?o.map(e=>{const s="localfs"===e.type?Q:"webdav"===e.type?X:Y;return t.jsxs("div",{className:C("group relative flex items-center p-2 px-3 transition-all duration-200 hover:shadow-sm border rounded-lg bg-background hover:bg-accent/50",e.isEnabled?"border-l-4 border-l-green-600 dark:border-l-green-500 shadow-sm":"border-l-4 border-l-muted border-y-border border-r-border"),children:[t.jsx("div",{className:C("flex items-center justify-center w-8 h-8 rounded-md mr-3 shrink-0 transition-colors",e.isEnabled?"bg-green-100 text-green-600 dark:bg-green-500/20 dark:text-green-400":"bg-muted text-muted-foreground"),children:t.jsx(s,{className:"h-4.5 w-4.5"})}),t.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"text-lg tabular-nums text-muted-foreground font-mono font-bold",children:["#",e.id]}),t.jsx("span",{className:"text-sm font-semibold truncate min-w-20 text-foreground",children:a(`ui.storage.storageType.${e.type}`)})]}),t.jsxs("span",{className:C("inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-medium transition-colors",e.isEnabled?"bg-green-100 text-green-700 dark:bg-green-500/20 dark:text-green-400":"bg-muted text-muted-foreground"),children:[e.isEnabled?t.jsx(Z,{className:"h-2.5 w-2.5"}):null,e.isEnabled?a("ui.common.isEnabled"):a("ui.common.isDisabled")]})]}),e.accessUrlPrefix&&t.jsxs("div",{className:"hidden lg:flex items-center ml-6 text-xs text-muted-foreground truncate max-w-75 shrink overflow-hidden",children:[t.jsx(ee,{className:"h-3 w-3 mr-1 opacity-50"}),t.jsx("span",{className:"truncate opacity-70 hover:opacity-100 transition-opacity",title:e.accessUrlPrefix,children:e.accessUrlPrefix})]})]}),t.jsxs("div",{className:"flex items-center pl-2 ml-2 border-l border-border space-x-0.5",children:[t.jsx(E,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-primary hover:bg-primary/10 rounded-md transition-all",onClick:()=>{return s=e.id,l(null),void setTimeout(()=>l(s),0);var s},children:t.jsx(O,{className:"h-3.5 w-3.5"})}),t.jsx(E,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-md transition-all",onClick:()=>(async e=>{r(a("ui.storage.confirmDelete"),"confirm",async()=>{await T(e),await $()})})(e.id),children:t.jsx(M,{className:"h-3.5 w-3.5"})})]})]},e.id)}):t.jsxs("div",{className:"py-12 flex flex-col items-center justify-center text-muted-foreground border-2 border-dashed border-border/50 rounded-xl bg-muted/20 mt-4",children:[t.jsx(W,{className:"h-12 w-12 mb-3 opacity-20"}),t.jsx("p",{className:"text-sm opacity-70 font-medium",children:a("ui.storage.noStorage")})]})})]})}),y&&t.jsx(me,{configId:y,configType:v,open:w,onOpenChange:S})]})}export{ge as SyncBackup};

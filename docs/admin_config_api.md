# 管理员配置接口文档 (`/api/admin/config`)

本文档描述了管理员用于获取和更新系统配置的 API 接口。配置参数同步自 `config/config.yaml`。

---

## 1. 概述

该接口允许具有管理员权限的用户查看和修改系统的核心配置。配置修改后会即时生效并持久化到服务器的配置文件中。

- **基础路径**: `/api/admin/config`
- **认证方式**: 需要 `Authorization` 请求头传递 `Token`。
- **权限要求**: 仅限管理员（`AdminUID` 匹配的用户）访问。如果 `adminUid` 设置为 `0`，则默认不限制管理员访问权限（慎用）。

---

## 2. 获取配置 (`GET`)

获取当前的系统配置信息。

### 请求头
| 参数名          | 类型     | 是否必选 | 说明                 |
|:----------------|:---------|:---------|:---------------------|
| `Authorization` | `string` | 是       | 用户登录令牌 (Token) |

### 响应示例
**状态码**: `200 OK`

```json
{
  "code": 1,
  "status": true,
  "message": "成功",
  "data": {
    "fontSet": "local",
    "registerIsEnable": true,
    "fileChunkSize": "512KB",
    "softDeleteRetentionTime": "7d",
    "uploadSessionTimeout": "1d",
    "adminUid": 0
  }
}
```

---

## 3. 更新配置 (`POST`)

更新系统配置信息。

### 请求头
| 参数名          | 类型     | 是否必选 | 说明                 |
|:----------------|:---------|:---------|:---------------------|
| `Authorization` | `string` | 是       | 用户登录令牌 (Token) |
| `Content-Type`  | `string` | 是       | `application/json`   |

### 请求参数 (JSON)
| 参数名                    | 类型      | 示例值    | 说明               |
|:--------------------------|:----------|:----------|:-------------------|
| `fontSet`                 | `string`  | `"local"` | 界面字体设置       |
| `registerIsEnable`        | `boolean` | `true`    | 是否开启用户注册   |
| `fileChunkSize`           | `string`  | `"1MB"`   | 文件同步分块大小   |
| `softDeleteRetentionTime` | `string`  | `"30d"`   | 软删除笔记保留时长 |
| `uploadSessionTimeout`    | `string`  | `"24h"`   | 上传会话过期时间   |
| `adminUid`                | `integer` | `1`       | 管理员 UID         |

---

## 4. 参数详情与默认值

| 字段                      | 类型      | 默认值    | 详细描述                                                                                                                                       |
|:--------------------------|:----------|:----------|:-----------------------------------------------------------------------------------------------------------------------------------------------|
| `fontSet`                 | `string`  | `"local"` | **字体设置**：<br>• 留空：不设置特定字体。<br>• `local`：使用系统本地字体。<br>• 字体链接：从网络加载特定字体。                                       |
| `registerIsEnable`        | `boolean` | `true`    | **注册开关**：控制是否允许新用户注册。若关闭，注册 API 将返回错误。                                                                                |
| `fileChunkSize`           | `string`  | `"512KB"` | **分块大小**：文件上传和下载时的分块大小。支持单位：`B`, `KB`, `MB`, `GB`（如 `1MB`, `1024`）。`0` 表示默认 512KB。                                   |
| `softDeleteRetentionTime` | `string`  | `"7d"`    | **软删除保留时长**：笔记删除后进入回收站的保留时间（如 `30d`, `12h`）。超过此时间将被物理删除。建议设置足够长以确保离线设备同步。`0` 表示不自动清理。 |
| `uploadSessionTimeout`    | `string`  | `"1d"`    | **上传会话超时**：文件分块上传会话的有效期（如 `5m`, `1d`）。`0` 表示永不超时。                                                                     |
| `adminUid`                | `integer` | `0`       | **管理员 UID**：指定特定的用户 UID 作为管理员。`0` 表示不启用特定的管理员权限校验逻辑（建议在初始化后设置为实际的管理员 UID）。                     |

---

## 5. 常见错误

| 状态码 | 业务代码 (code) | 说明                                                              |
|:-------|:----------------|:------------------------------------------------------------------|
| `401`  | `508`           | 登录状态失效，请重新登录。                                          |
| `200`  | `445`           | **此操作需要管理员权限**：当前登录 UID 与配置的 `adminUid` 不匹配。 |
| `200`  | `505`           | **参数验证失败**：请求数据格式不正确，或时间/容量格式无法解析。      |
